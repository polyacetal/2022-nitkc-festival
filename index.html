<!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="utf-8" />
		<title>釧路高専祭</title>
		<style type="text/css">
			canvas{border: 1px solid black;}
		</style>
		<link rel="stylesheet" type="text/css" href="style.css">
	</head>
	<script>
		window.addEventListener('load', eventWindowLoaded, false);
		function eventWindowLoaded() {
			mainApp();
		}

		function mainApp() {
			//canvas オブジェクトの取得
			var canvas = document.getElementById('mycanvas');
			//ブラウザがcanvasに対応してなかったとき
			if(!canvas.getContext){
				return;
			}
			//canvasコンテキストの取得
			var cont = canvas.getContext('2d');

			var screenWidth = canvas.width;
			var screenHeight = canvas.height;
			var mode = "square";

			function DrawSquare(x, y) {
				cont.fillStyle = 'black';
				cont.fillRect(x, y, 100, 100);
				cont.clearRect(x + 20, y + 20, 60, 60);
				cont.strokeRect(x + 25, y + 25, 50, 50);
			}
			
			function DrawRound(x, y) {
				cont.beginPath();
				cont.arc(x, y, 50, 0, Math.PI * 2, false);
				cont.fillStyle = 'black';
				cont.fill();
				cont.closePath();
				cont.beginPath();
				cont.arc(x, y, 30, 0, Math.PI * 2, false);
				cont.fillStyle = 'white';
				cont.fill();
				cont.closePath();
				cont.beginPath();
				cont.arc(x, y, 25, 0, Math.PI * 2, false);
				cont.closePath();
				cont.stroke();
				cont.closePath();
			}

			function TouchDraw(e) {
				var rect = e.target.getBoundingClientRect();
				var x = e.clientX - rect.left;
				var y = e.clientY - rect.top;

				switch(mode){
					case "square":
						DrawSquare(x - 50, y - 50);
						break;
					case "round":
						DrawRound(x, y);
						break;
				} 
			}

			function Clear() {
				cont.clearRect(0, 0, screenWidth, screenHeight);
			}

			function PushBtn(e) {
				var btnId = document.getElementById(e.target.id);
				btnId.style.background = '#000000';
				btnId.style.color = '#ffffff';
			}

			function BtnColorReset() {
				bt1.style.background = '#ffffff';
				bt1.style.color = '#000000';
				bt2.style.background = '#ffffff';
				bt2.style.color = '#000000';
				bt3.style.background = '#ffffff';
				bt3.style.color = '#000000';
			}

			canvas.addEventListener('click', TouchDraw, false);
			var bt1 = document.getElementById("button1");
			bt1.addEventListener('click', (e) => {BtnColorReset();Clear()}, false);
			var bt2 = document.getElementById("button2");
			bt2.addEventListener('click', (e) => {PushBtn(e);mode = "square"}, false);
			var bt3 = document.getElementById("button3");
			bt3.addEventListener('click', (e) => {PushBtn(e);mode = "round"}, false);
		}
	</script>
	<body>
		<h1> 
		<div id="canvasblock">
			<canvas id="mycanvas" width="800" height="800">
				このブラウザはCanvasに対応していません。
			</canvas>
		</div>
		<img id="qr" src="./QR_code.png" \>
		<div class="button">
			<input type="button" id="button1" class="btn" value="全消去">
			<input type="button" id="button2" class="btn" value="四角スタンプ">
			<input type="button" id="button3" class="btn" value="丸スタンプ">
		</div>
	</body>
</html>
